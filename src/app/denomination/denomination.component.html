<div *ngIf="hidecontent" class="hk-wrapper">

  <!-- Main Content -->
  <div class="hk-pg-wrapper hk-auth-wrapper">
    <header class="d-flex justify-content-end align-items-center">
      <div class="btn-group btn-group-sm">
        <a href="#" class="btn btn-outline-secondary">Help</a>
        <a href="#" class="btn btn-outline-secondary">About Us</a>
      </div>
    </header>
    <div class="container-fluid">
      <div class="row">
        <div class="col-xl-12 pa-0">
          <div class="auth-form-wrap pt-xl-0 pt-70">
            <div class="auth-form w-xl-25 w-lg-30 w-sm-50 w-100">

              <form>
                <div
                  class="d-62 bg-white rounded-circle mb-10 d-flex align-items-center justify-content-center mx-auto">
                  <i class="zmdi zmdi-settings font-28"></i>
                </div>
                <h1 class="display-4 mb-10 text-center"> <span unselectable="on" class="no-select"
                    (click)="unlockpagr('sorry')">Sorry</span>
                  we <span unselectable="on" class="no-select" (click)="unlockpagr('are')">are</span>
                  down for <span (click)="unlockpagr('maintenance')">maintenance</span></h1>
                <p class="mb-30 text-center">We apologize for the inconvenience, we are doing our best
                  to get things back in order for you. Please feel free to <a href="#"><u>contact
                      us</u></a> for any queries.</p>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- /Main Content -->

</div>

<div *ngIf="!hidecontent" class="hk-pg-wrapper">
  <!-- Breadcrumb -->
  <nav class="hk-breadcrumb" aria-label="breadcrumb">
    <ol class="breadcrumb breadcrumb-light bg-transparent">
      <li class="breadcrumb-item"><a href="javascript:void(0);">Company Management</a></li>
      <li class="breadcrumb-item active pointer" (click)="denomcheckreport()" aria-current="page">Denomination Entries
      </li>
    </ol>
  </nav>
  <!-- /Breadcrumb -->
  <section class="hk-sec-wrapper">
    <div class="col-xl-12 row mb-20">
      <div class="col-xl-3">
        <label for="appt1">From:</label>
        <input type="time" class="form-control" name="appt1" [(ngModel)]="from">
      </div>
      <div class="col-xl-3">
        <label for="appt2">To:</label>
        <input type="time" class="form-control" name="appt2" [(ngModel)]="to">
      </div>
      <div class="col-xl-3">
        <label for="appt3">Margin:</label>
        <input type="number" class="form-control" name="appt3" [(ngModel)]="diffMargin">
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-link" (click)="getDenomReport()">Report</button>
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-link" [disabled]="!storeid" (click)="openPettyCash()">PCT</button>
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-link" (click)="exportToExcel()">Export</button>
      </div>
      <div class="col-xl-3">
        <label for="cars">Choose a Store: </label>
        <div>
          <ng-template class="w-100" #rt let-r="result" let-t="term">
            <ngb-highlight [result]="r.Name" [term]="t"></ngb-highlight>
          </ng-template>
          <div style="height: 84%; position: relative;">
            <input id="typeahead-template" style="height: 100%;" #instance="ngbTypeahead" type="text"
              class="form-control" [(ngModel)]="smodel" placeholder="Search Store..." [ngbTypeahead]="search"
              [resultTemplate]="rt" [inputFormatter]="formatter" (selectItem)="selectedItem($event.item)" />
            <span *ngIf="smodel != ''" class="search-clear" aria-hidden="true"
              (click)="smodel = '';storeid = 0;loginfo.StoreId = 0">×</span>
          </div>
        </div>
      </div>
      <div class="col-xl-3">
        <label for="cars">Choose an Entry Type: </label>
        <select name="cars" id="cars" class="form-control" [(ngModel)]="entrytypeid">
          <option value={{entrytype.id}} *ngFor="let entrytype of entrytypes">{{entrytype.type}}</option>
        </select>
      </div>
      <div class="col-xl-3">
        <label for="cars">Selec a date: </label>
        <input type="text" *ngIf="!showcalender" class="form-control" [(ngModel)]="displaydate"
          (focusin)="showcalender = true">
        <ngb-datepicker #dp *ngIf="showcalender" [(ngModel)]="model" (ngModelChange)="onDateSelect($event)"
          (navigate)="date = $event.next"></ngb-datepicker>
        <span *ngIf="showcalender" class="search-clear" aria-hidden="true" (click)="showcalender = false">×</span>
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-success" (click)="fetchdenomentries()">Submit</button>
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-secondary" (click)="opencopymodal()">Copy</button>
      </div>
      <div class="col-xl-1">
        <label for="cars" style="color: #f4f6f7;">Click: </label>
        <button class="btn btn-danger" [disabled]="!storeid" (click)="openDrawer()">Entry</button>
      </div>
    </div>
  </section>
  <div class="col-xl-12">
    <div class="accordion">
      <div class="w-100" *ngFor="let denomentry of denomentries; let i = index;">
        <div class="card-header position-relative"
          [ngClass]="{'edited' : denomentry.edited, 'bg-white' : !denomentry.edited}" id="headingOne"
          (click)="denomentry.isCollapsed = !denomentry.isCollapsed" [attr.aria-expanded]="denomentry.isCollapsed"
          aria-controls="collapseExample">
          <div class="card-title ant-typography"><span class="accordion-indicator pull-right"><i
                class="plus fe fe-plus"></i><i class="minus fe fe-minus"></i></span>
            <i *ngIf="denomentry.edited" class="text-warning pull-right">This entry is edited. See
              <code>#{{denomentry.editid}}</code> for updated data.</i>
            <code>#{{denomentry.Id}}</code><a>{{denomentry.EntryDateTime | date: 'MMM d,
              y, h:mm a'}}
              by {{denomentry.UserName}} | <i>{{denomentry.storename}} | {{denomentry.Remarks}}
                {{denomentry.diff >= 0 ? denomentry.diff : denomentry.diff * -1}}</i>
            </a>

            <br>
            <span><i>{{
                denomentry.EntryTypeId == 1 ? 'Sent to Store' :
                denomentry.EntryTypeId == 2 ? 'Closing' :
                denomentry.EntryTypeId == 3 ? 'Expense Cash' :
                denomentry.EntryTypeId == 4 ? 'Closing Expense Cash' :
                denomentry.EntryTypeId == 5 ? 'Sales Cash' :
                denomentry.EntryTypeId == 6 ? 'Closing Sales Cash' : 'Regular'}}</i></span>
            <span class="float-right font-italic mr-30"><i class="fa fa-clock-o"></i>{{denomentry.shift}}</span>
          </div>
          <button class="btn btn-outline-danger btn-xs position-absolute"
            (click)="openconfirmdeletemodal(denomentry.Id)" style="top: 0; right: 0; margin: 10px;">
            <i class="fa fa-trash"></i>
          </button>
        </div>
        <div toggler="#headingOne" class="collapse" [ngbCollapse]="!denomentry.isCollapsed">
          <div class="card-body col-xl-12 row">
            <div class="mb-5 col-xl-4">
              <ul class="list-group mb-4">
                <li class="list-group-item" *ngFor="let entry of denomentry.Entries">
                  Rs.{{entry.DenomName}} x {{entry.Count}}
                  <span class="float-right">{{entry.Amount}}</span>
                </li>
              </ul>
              <hr class="hr-text" data-content="O N L I N E">
              <ul class="list-group mb-4">
                <li class="list-group-item">
                  Phone Pe
                  <span class="float-right">{{denomentry.PhonePe}}</span>
                </li>
                <li class="list-group-item">
                  Card
                  <span class="float-right">{{denomentry.Card}}</span>
                </li>
              </ul>
            </div>
            <div class="col-xl-8">
              <section class="hk-sec-wrapper">
                <div class="d-flex mb-3">
                  <select class="form-control col-xl-5" [(ngModel)]="denomentry.ShiftId"
                    (change)="denomentry.dirty = true">
                    <option *ngFor="let shift of shifts" value="{{shift.shiftid}}">{{shift.shift}}</option>
                  </select>
                  <button [disabled]="!denomentry.dirty || denomentry.loading" class="btn btn-sm btn-warning ml-1"
                    (click)="changeshift(denomentry.Id, denomentry.ShiftId, i)">
                    {{denomentry.loading ? "Changing..." : "Change"}}
                  </button>
                </div>
                <div class="d-flex">
                  <div class="col-xl-4">
                    <table class="flat table table-bordered table-sm">
                      <tbody class="border">
                        <tr>
                          <td>Opening Bal.</td>
                          <td>{{denomentry.OpeningBalance}}</td>
                        </tr>
                        <tr>
                          <td>Cash In</td>
                          <td>{{denomentry.CashIn}} - {{denomentry.PCT_IN}}</td>
                        </tr>
                        <tr>
                          <td>Cash Out</td>
                          <td>{{denomentry.CashOut}} - {{denomentry.PCT_OUT}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="col-xl-8">
                    <table class="flat table table-bordered table-sm">
                      <tbody class="border">
                        <tr>
                          <td>Sales</td>
                          <td>Actual</td>
                          <td>Expected</td>
                          <td colspan="2">Remarks</td>
                        </tr>
                        <tr>
                          <td>Cash</td>
                          <td>{{denomentry.TotalAmount}}</td>
                          <td>{{denomentry.SalesCash + denomentry.OpeningBalance}}</td>
                          <td>{{denomentry.TotalAmount - denomentry.SalesCash - denomentry.OpeningBalance}}</td>
                          <td
                            [innerHTML]="denomentry.TotalAmount - denomentry.SalesCash - denomentry.OpeningBalance | remark">
                          </td>
                        </tr>
                        <tr>
                          <td>Card</td>
                          <td>{{denomentry.Card}}</td>
                          <td>{{denomentry.SalesCard}}</td>
                          <td>{{denomentry.Card - denomentry.SalesCard}}</td>
                          <td [innerHTML]="denomentry.Card - denomentry.SalesCard | remark"></td>
                        </tr>
                        <tr>
                          <td>PhonePe</td>
                          <td>{{denomentry.PhonePe}}</td>
                          <td>{{denomentry.SalesPhonePe}}</td>
                          <td>{{denomentry.PhonePe - denomentry.SalesPhonePe}}</td>
                          <td [innerHTML]="denomentry.PhonePe - denomentry.SalesPhonePe | remark"></td>
                        </tr>
                        <tr>
                          <td colspan="2"></td>
                          <td>Total Diff</td>
                          <td colspan="2">{{denomentry.TotalAmount - denomentry.SalesCash + denomentry.Card -
                            denomentry.SalesCard + denomentry.PhonePe - denomentry.SalesPhonePe}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </section>
              <!-- <i class="text-warning">Contact your admin for more information</i> -->
              <!-- <strong>Opening Balance: </strong> {{denomentry.OpeningBalance}} <br>
              <strong>Sales Cash: </strong> {{denomentry.SalesCash}}
              <button *ngIf="denomentry.SalesCash&&!denomentry.showSalesTrnx"
                (click)="denomentry.showSalesTrnx = !denomentry.showSalesTrnx" class="btn btn-link text-success"><i
                  class="fa fa-plus"></i></button>
              <button *ngIf="denomentry.showSalesTrnx" (click)="denomentry.showSalesTrnx = !denomentry.showSalesTrnx"
                class="btn btn-link text-danger"><i class="fa fa-minus"></i></button>
              <br>
              <div *ngIf="denomentry.showSalesTrnx" style="max-height: 300px; overflow: auto;">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Amount</th>
                      <th scope="col">Transaction Date Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let transaxn of denomentry.SalesTransaxns">
                      <td scope="row"><code>#{{ transaxn.InvoiceNo }}</code></td>
                      <td>{{ transaxn.Amount | number }}</td>
                      <td>{{ transaxn.TransDateTime | date: 'MMM d, y, h:mm a' }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <strong>CashIn:
              </strong> {{denomentry.CashIn}} ({{denomentry.PCT_IN}})
              <button *ngIf="(denomentry.CashIn || denomentry.PCT_IN)&&!denomentry.showCashIn"
                (click)="denomentry.showCashIn = !denomentry.showCashIn" class="btn btn-link text-success"><i
                  class="fa fa-plus"></i></button>
              <button *ngIf="denomentry.showCashIn" (click)="denomentry.showCashIn = !denomentry.showCashIn"
                class="btn btn-link text-danger"><i class="fa fa-minus"></i></button>
              <br>
              <div *ngIf="denomentry.showCashIn" style="max-height: 300px; overflow: auto;">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Name</th>
                      <th scope="col">Amount</th>
                      <th scope="col">Transaction Date Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let transaxn of denomentry.CashInTransaxns">
                      <td *ngIf="transaxn.PaymentTypeId != 7" scope="row">
                        <code>#{{ transaxn.TransactionId }}</code>
                      </td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.Name }}</td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.Amount | number }}</td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.TransDateTime | date:
                        'MMM d, y, h:mm a' }}</td>

                      <td *ngIf="transaxn.PaymentTypeId == 7" scope="row">
                        <code>#{{ transaxn.Id }}</code>
                      </td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.InvoiceNo }}</td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.Amount | number }}</td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.TransDateTime | date:
                        'MMM d, y, h:mm a' }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <strong>CashOut: </strong>
              {{denomentry.CashOut}} ({{denomentry.PCT_OUT}})
              <button *ngIf="(denomentry.CashOut || denomentry.PCT_OUT)&&!denomentry.showCashOut"
                (click)="denomentry.showCashOut = !denomentry.showCashOut" class="btn btn-link text-success"><i
                  class="fa fa-plus"></i></button>
              <button *ngIf="denomentry.showCashOut" (click)="denomentry.showCashOut = !denomentry.showCashOut"
                class="btn btn-link text-danger"><i class="fa fa-minus"></i></button>
              <br>
              <div *ngIf="denomentry.showCashOut">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Name</th>
                      <th scope="col">Amount</th>
                      <th scope="col">Transaction Date Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let transaxn of denomentry.CashOutTransaxns">
                      <td *ngIf="transaxn.PaymentTypeId != 7" scope="row">
                        <code>#{{ transaxn.TransactionId }}</code>
                      </td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.Name }}</td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.Amount | number }}</td>
                      <td *ngIf="transaxn.PaymentTypeId != 7">{{ transaxn.TransDateTime | date:
                        'MMM d, y, h:mm a' }}</td>

                      <td *ngIf="transaxn.PaymentTypeId == 7" scope="row">
                        <code>#{{ transaxn.Id }}</code>
                      </td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.InvoiceNo }}</td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.Amount | number }}</td>
                      <td *ngIf="transaxn.PaymentTypeId == 7">{{ transaxn.TransDateTime | date:
                        'MMM d, y, h:mm a' }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <strong>Expected Balance: </strong> {{denomentry.ExpectedBalance}} <br>
              <strong>Actual Balance: </strong> {{denomentry.TotalAmount}} <br>
              <strong>Remarks: </strong> {{denomentry.diff}}
              <span
                [ngClass]="{'text-warning': denomentry.diff > 0, 'text-success': denomentry.diff == 0, 'text-danger': denomentry.diff < 0}">{{denomentry.Remarks}}</span><br>
              <span *ngIf="denomentry.compared_value">
                <strong>Last compared difference: </strong>
                {{denomentry.compared_value}}
              </span>
              <p *ngIf="denomentry.PCT_FACTOR != 0 && denomentry.PCT != 0" class="font-italic"
                [ngClass]="{'text-success': denomentry.PCT > 0, 'text-danger': denomentry.PCT < 0}">
                *{{denomentry.PCT_remark}}</p> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #delet_confirmation_modal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Warning!</h5>
    <!-- <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <span aria-hidden="true">&times;</span>
      </button> -->
  </div>
  <div class="modal-body">
    <p>Do you wanna delete the denomination?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="modal.close('Cross click')">Cancel</button>
    <button type="button" class="btn btn-danger" (click)="deleteDenomEntry()">Delete</button>
  </div>
</ng-template>

<ng-template #copy_data_modal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Copy Data</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="card-body">
      <textarea #copyfield [(ngModel)]="copydata" class="form-control" cols="30" rows="50"></textarea>
    </div>
    <!-- <button [disabled]="splitpaymenttotal == 0 || splitpaymenttotal > order.BillAmount" class="btn btn-success"
          (click)="makesplitpayment()">Pay</button> -->
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="delete_denom_id=0;modal.close('Save click')">Cancel</button>
    <button type="button" class="btn btn-primary" (click)="deleteDenomEntry()">Do Something</button>
  </div>
</ng-template>

<ng-template #denomReport let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Report</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="col-xl-12 row">
      <div class="col-xl-6">
        <h3>Bad Stores</h3>
        <!-- <div *ngFor="let entry of badStores">

              </div> -->
        <textarea [(ngModel)]="badStoresString" cols="30" rows="10"></textarea>
        <div class="form-control">
          <input type="checkbox" name="withDifference" [(ngModel)]="withDifference" (change)="genBadStoresString()">
          <label for="withDifference">Show Difference</label>
        </div>
      </div>
      <div class="col-xl-6">
        <h3>Missing Stores</h3>
        <textarea [(ngModel)]="missingStoresString" cols="30" rows="10"></textarea>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="modal.close('Save click')">Cancel</button>
    <button type="button" class="btn btn-primary" (click)="modal.close('Save click')">Do Something</button>
  </div>
</ng-template>

<ng-template #pettycashtransfermodal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Petty cash Transfer</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-xl-6">
        <label for="">Sales Cash ({{store_petty_cash.salescash}} + {{store_petty_cash.cashSales}})</label>
        <input class="form-control" readonly [(ngModel)]="store_petty_cash.salescash + store_petty_cash.cashSales">
      </div>
      <div class="col-xl-6">
        <label for="">Expense Cash</label>
        <input class="form-control" readonly [(ngModel)]="store_petty_cash.expensecash">
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-xl-5">
        <input class="form-control" (input)="store_petty_cash.fromExpense = null" type="number"
          [(ngModel)]="store_petty_cash.fromSales">
        <span
          *ngIf="store_petty_cash.fromSales && (store_petty_cash.fromSales > store_petty_cash.salescash + store_petty_cash.cashSales)"
          class="font-11 text-danger">*amount cannot exceed sales cash</span>
      </div>
      <div class="col-xl-2">
        <button *ngIf="store_petty_cash.fromSales && store_petty_cash.fromSales > 0"
          [disabled]="store_petty_cash.fromSales && (store_petty_cash.fromSales > store_petty_cash.salescash + store_petty_cash.cashSales)"
          (click)="transfer()" aria-label="Example icon button with a vertical three dot icon"
          class="antifocus text-danger ">
          >
        </button>
        <button *ngIf="store_petty_cash.fromExpense && store_petty_cash.fromExpense > 0"
          [disabled]="(store_petty_cash.fromExpense && store_petty_cash.expensecash) && store_petty_cash.fromExpense > store_petty_cash.expensecash"
          (click)="transfer()" aria-label="Example icon button with a vertical three dot icon"
          class="antifocus text-danger ">
          < </button>
      </div>
      <div class="col-xl-5">
        <input class="form-control" (input)="store_petty_cash.fromSales = null" type="number"
          [(ngModel)]="store_petty_cash.fromExpense">
        <span
          *ngIf="(store_petty_cash.fromExpense && store_petty_cash.expensecash) && store_petty_cash.fromExpense > store_petty_cash.expensecash"
          class="font-11 text-danger">*amount cannot exceed expense cash</span>
      </div>
    </div>
    <div class="form-group">
      <label for="">Transfer Reason</label>
      <textarea class="form-control" [(ngModel)]="store_petty_cash.transferReason" cols="30" rows="2"></textarea>
      <span *ngIf="store_petty_cash.transferAmount > 0">Transfer amount of
        <strong>Rs.{{store_petty_cash.transferAmount}}</strong>
        from <strong>
          {{
          store_petty_cash.to == "EXPENSE" ? "Sales" : "Expense"
          }}
          cash</strong> to <strong>
          {{
          store_petty_cash.to == "EXPENSE" ? "Expense" : "Sales"
          }} cash
        </strong></span>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="cancelTransfer();modal.close('Save click')">Cancel</button>
    <button type="button" class="btn btn-primary" (click)="completeTransfer()">Transfer</button>
  </div>
</ng-template>

<div class="biz-drawer p-4" [ngStyle]="{'right': visible ? '0' : '-40%'}">
  <div class="modal-header">
    <h5 class="modal-title">Denomination Entry</h5>
    <button type="button" class="close" aria-label="Close" (click)="visible = false;">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" *ngIf="visible">
    <div class="row">
      <div class="col-xl-12 form-group">
        <select name="cars" id="cars" class="form-control" [(ngModel)]="denomEntry.EntryTypeId">
          <option value=null>Regular</option>
          <option value=1>Send to Store</option>
          <option value=2>Closing</option>
          <option value=3>Expense Cash</option>
          <option value=4>Closing Expense Cash</option>
          <option value=5>Sales Cash</option>
          <option value=6>Closing Sales Cash</option>
        </select>
      </div>
    </div>
    <label for="">Entry Date Time</label>
    <div class="row col-xl-12">
      <input type="date" class="form-control col-xl-6" [(ngModel)]="entrydatetime.date">
      <input type="time" class="form-control col-xl-6" [(ngModel)]="entrydatetime.time">
    </div>
    <br>
    <div class="col-xl-12 row" style="max-height: 60vh; overflow: auto;">
      <div class="col-xl-6 row">
        <div class="row mb-2" *ngFor="let entry of denomEntry?.Entries">
          <input type="text" [(ngModel)]="'₹'+entry.DenomName" #denomination class="form-control col-sm mx-1"
            name="denomination" disabled>
          <input type="number" [(ngModel)]="entry.Count" #count class="form-control col-sm mx-1" name="count"
            (input)="calculate()">
          <div>
            <button *ngIf="entry.Count && entry.Count > 0" class="btn btn-link text-danger mx-1"
              (click)="entry.Count = null;calculate()"><i class="fa fa-times"></i></button>
            <button *ngIf="!entry.Count || entry.Count <= 0" disabled class="btn btn-link text-white mx-1"><i
                class="fa fa-times"></i></button>
          </div>
        </div>
      </div>
      <div class="col-xl-6">
        <div class="text-right">
          <strong>Total Amount: </strong>{{denomEntry?.TotalAmount}} <br>
          <button class="btn btn-success" (click)="save()">Save</button>
        </div>
        <!-- <ul class="list-group mb-4">
                  <li class="list-group-item" *ngFor="let entry of denomEntry.Entries; let i = index">
                      Rs.{{entry.DenomName}} x {{entry.Count}}
                      <button class="btn btn-link text-danger float-right py-0" (click)="deleteEntry(i)"><i
                              class="fe fe-trash"></i></button>
                      <span class="float-right">{{entry.Amount}}</span>
                  </li>
                  <li class="list-group-item" *ngIf="denomEntry.Entries.length">
                      <Strong>Total</Strong>
                      <button disabled class="btn btn-link text-white float-right py-0"><i
                              class="fa fa-times"></i></button>
                      <span class="float-right">{{denomEntry.TotalAmount}}</span>
                  </li>
              </ul>
              <button class="btn btn-success pull-right" *ngIf="denomEntry.Entries.length">Save</button> -->
      </div>
    </div>
  </div>
</div>
<ng-template #denomcheckreportmodal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Denom Check Report</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" style="overflow: auto; max-height: 80vh;">
    <div class="table-wrap" style="width: max-content;">
      <div class="table-responsive">
        <div class="d-flex w-100">
          <div class="form-group">
            <label>MARGIN:</label> <input class="form-control" type="number" [(ngModel)]="margin">
          </div>
          <div>
            <button class="btn btn-success" [class.btn-outline-success]="!phonepe"
              (click)="phonepe = !phonepe">PhonePe</button>
            <button class="btn btn-success" [class.btn-outline-success]="!card" (click)="card = !card">Card</button>
          </div>
        </div>
        <!-- <table>
          <table>
            <tr>
              <th>
                <input type="checkbox" [(ngModel)]="hideHeader2"
                  (change)="onCheckboxChange(hideHeader2, 'hideHeader2')" />
                First Shift
              </th>&nbsp;&nbsp;
              <th>
                <input type="checkbox" [(ngModel)]="hideHeader1"
                  (change)="onCheckboxChange(hideHeader1, 'hideHeader1')" />
                Second Shift
              </th>
              <th>
                <input [(ngModel)]="margin" type="range" min="0" max="1000" ondblclick="margin = 100" value="50">
              </th>
            </tr>
          </table>
        </table> -->


        <table class="table table-hover table-bordered mb-0" id="denomIMg">
          <thead>
            <tr>
              <th>Store</th>
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader1" class="shift1">
                {{shifts[1].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader1" class="shift2">
                {{shifts[2].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader1" class="shift3">
                {{shifts[3].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader1" class="shift4">
                {{shifts[4].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader2" class="shift5">
                {{shifts[5].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader2" class="shift6">
                {{shifts[6].shift}}</th>
              <!-- <td class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <th [attr.colspan]="1 + (phonepe ? 1 : 0) + (card ? 1 : 0)" *ngIf="!hideHeader2" class="shift7">
                {{shifts[7].shift}}</th>
            </tr>
            <tr>
              <th></th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
              <th>CASH</th>
              <th *ngIf="phonepe">PHONE PE</th>
              <th *ngIf="card">CARD</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let rpt of denomcheckreports; let i = index">
              <td>{{rpt.Name}}</td>
              <td
                [ngClass]="{'excess': rpt.shift1s > margin, 'shortage': rpt.shift1s < margin*-1, 'tallied': rpt.shift1s >= margin*-1 && rpt.shift1s <= margin && rpt.shift1s != null}"
                (mouseenter)="rpt['1s'+i] = true" (mouseleave)="rpt['1s'+i] = false" *ngIf="!hideHeader1"
                class="shift1 cash">
                {{rpt.shift1s == null ? 'No Rec' : rpt.shift1s}}
                <span *ngIf="rpt['1s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:00 am to 11:59 am</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader1"
                [ngClass]="{'excess': rpt.shift1p > margin, 'shortage': rpt.shift1p < margin*-1, 'tallied': rpt.shift1p >= margin*-1 && rpt.shift1p <= margin && rpt.shift1p != null}"
                (mouseenter)="rpt['1p'+i] = true" (mouseleave)="rpt['1p'+i] = false" class="shift1 phonepe">
                {{rpt.shift1p == null ? 'No Rec' : rpt.shift1p}}
                <span *ngIf="rpt['1p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:00 am to 11:59 am</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader1"
                [ngClass]="{'excess': rpt.shift1c > margin, 'shortage': rpt.shift1c < margin*-1, 'tallied': rpt.shift1c >= margin*-1 && rpt.shift1c <= margin && rpt.shift1c != null}"
                class="gap-right" (mouseenter)="rpt['1c'+i] = true" (mouseleave)="rpt['1c'+i] = false"
                class="shift1 cardpt">
                {{rpt.shift1c == null ? 'No Rec' : rpt.shift1c}}
                <span *ngIf="rpt['1c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:00 am to 11:59 am</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift2s > margin, 'shortage': rpt.shift2s < margin*-1, 'tallied': rpt.shift2s >= margin*-1 && rpt.shift2s <= margin && rpt.shift2s != null}"
                (mouseenter)="rpt['2s'+i] = true" (mouseleave)="rpt['2s'+i] = false" *ngIf="!hideHeader1"
                class="shift2 cash">
                {{rpt.shift2s == null ? 'No Rec' : rpt.shift2s}}
                <span *ngIf="rpt['2s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>12:00 pm to 02:00 pm</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader1"
                [ngClass]="{'excess': rpt.shift2p > margin, 'shortage': rpt.shift2p < margin*-1, 'tallied': rpt.shift2p >= margin*-1 && rpt.shift2p <= margin && rpt.shift2p != null}"
                (mouseenter)="rpt['2p'+i] = true" (mouseleave)="rpt['2p'+i] = false" class="shift2 phonepe">
                {{rpt.shift2p == null ? 'No Rec' : rpt.shift2p}}
                <span *ngIf="rpt['2p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>12:00 pm to 02:29 pm</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader1"
                [ngClass]="{'excess': rpt.shift2c > margin, 'shortage': rpt.shift2c < margin*-1, 'tallied': rpt.shift2c >= margin*-1 && rpt.shift2c <= margin && rpt.shift2c != null}"
                class="gap-right" (mouseenter)="rpt['2c'+i] = true" (mouseleave)="rpt['2c'+i] = false"
                class="shift2 cardpt">
                {{rpt.shift2c == null ? 'No Rec' : rpt.shift2c}}
                <span *ngIf="rpt['2c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>12:00 pm to 02:29 pm</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift3s > margin, 'shortage': rpt.shift3s < margin*-1, 'tallied': rpt.shift3s >= margin*-1 && rpt.shift3s <= margin && rpt.shift3s != null}"
                (mouseenter)="rpt['3s'+i] = true" (mouseleave)="rpt['3s'+i] = false" *ngIf="!hideHeader1"
                class="shift3 cash">
                {{rpt.shift3s == null ? 'No Rec' : rpt.shift3s}}
                <span *ngIf="rpt['3s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>02:00 pm to 04:00 pm</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader1"
                [ngClass]="{'excess': rpt.shift3p > margin, 'shortage': rpt.shift3p < margin*-1, 'tallied': rpt.shift3p >= margin*-1 && rpt.shift3p <= margin && rpt.shift3p != null}"
                (mouseenter)="rpt['3p'+i] = true" (mouseleave)="rpt['3p'+i] = false" class="shift3 phonepe">
                {{rpt.shift3p == null ? 'No Rec' : rpt.shift3p}}
                <span *ngIf="rpt['3p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>02:30 pm to 04:29 pm</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader1"
                [ngClass]="{'excess': rpt.shift3c > margin, 'shortage': rpt.shift3c < margin*-1, 'tallied': rpt.shift3c >= margin*-1 && rpt.shift3c <= margin && rpt.shift3c != null}"
                class="gap-right" (mouseenter)="rpt['3c'+i] = true" (mouseleave)="rpt['3c'+i] = false"
                class="shift3 cardpt">
                {{rpt.shift3c == null ? 'No Rec' : rpt.shift3c}}
                <span *ngIf="rpt['3c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>02:30 pm to 04:29 pm</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift4s > margin, 'shortage': rpt.shift4s < margin*-1, 'tallied': rpt.shift4s >= margin*-1 && rpt.shift4s <= margin && rpt.shift4s != null}"
                (mouseenter)="rpt['4s'+i] = true" (mouseleave)="rpt['4s'+i] = false" *ngIf="!hideHeader1"
                class="shift4 cash">
                {{rpt.shift4s == null ? 'No Rec' : rpt.shift4s}}
                <span *ngIf="rpt['4s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>04:00 pm to 06:00 pm</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader1"
                [ngClass]="{'excess': rpt.shift4p > margin, 'shortage': rpt.shift4p < margin*-1, 'tallied': rpt.shift4p >= margin*-1 && rpt.shift4p <= margin && rpt.shift4p != null}"
                (mouseenter)="rpt['4p'+i] = true" (mouseleave)="rpt['4p'+i] = false" class="shift4 phonepe">
                {{rpt.shift4p == null ? 'No Rec' : rpt.shift4p}}
                <span *ngIf="rpt['4p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>04:30 pm to 06:29 pm</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader1"
                [ngClass]="{'excess': rpt.shift4c > margin, 'shortage': rpt.shift4c < margin*-1, 'tallied': rpt.shift4c >= margin*-1 && rpt.shift4c <= margin && rpt.shift4c != null}"
                class="gap-right" (mouseenter)="rpt['4c'+i] = true" (mouseleave)="rpt['4c'+i] = false"
                class="shift4 cardpt">
                {{rpt.shift4c == null ? 'No Rec' : rpt.shift4c}}
                <span *ngIf="rpt['4c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>04:30 pm to 06:29 pm</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift5s > margin, 'shortage': rpt.shift5s < margin*-1, 'tallied': rpt.shift5s >= margin*-1 && rpt.shift5s <= margin && rpt.shift5s != null}"
                (mouseenter)="rpt['5s'+i] = true" (mouseleave)="rpt['5s'+i] = false" *ngIf="!hideHeader2"
                class="shift5 cash">
                {{rpt.shift5s == null ? 'No Rec' : rpt.shift5s}}
                <span *ngIf="rpt['5s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>06:00 pm to 08:00 pm</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader2"
                [ngClass]="{'excess': rpt.shift5p > margin, 'shortage': rpt.shift5p < margin*-1, 'tallied': rpt.shift5p >= margin*-1 && rpt.shift5p <= margin && rpt.shift5p != null}"
                (mouseenter)="rpt['5p'+i] = true" (mouseleave)="rpt['5p'+i] = false" class="shift5 phonepe">
                {{rpt.shift5p == null ? 'No Rec' : rpt.shift5p}}
                <span *ngIf="rpt['5p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>06:30 pm to 08:30 pm</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader2"
                [ngClass]="{'excess': rpt.shift5c > margin, 'shortage': rpt.shift5c < margin*-1, 'tallied': rpt.shift5c >= margin*-1 && rpt.shift5c <= margin && rpt.shift5c != null}"
                class="gap-right" (mouseenter)="rpt['5c'+i] = true" (mouseleave)="rpt['5c'+i] = false"
                class="shift5 cardpt">
                {{rpt.shift5c == null ? 'No Rec' : rpt.shift5c}}
                <span *ngIf="rpt['5c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>06:30 pm to 08:30 pm</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift6s > margin, 'shortage': rpt.shift6s < margin*-1, 'tallied': rpt.shift6s >= margin*-1 && rpt.shift6s <= margin && rpt.shift6s != null}"
                (mouseenter)="rpt['6s'+i] = true" (mouseleave)="rpt['6s'+i] = false" *ngIf="!hideHeader2"
                class="shift6 cash">
                {{rpt.shift6s == null ? 'No Rec' : rpt.shift6s}}
                <span *ngIf="rpt['6s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:00 pm to 10:00 pm</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader2"
                [ngClass]="{'excess': rpt.shift6p > margin, 'shortage': rpt.shift6p < margin*-1, 'tallied': rpt.shift6p >= margin*-1 && rpt.shift6p <= margin && rpt.shift6p != null}"
                (mouseenter)="rpt['6p'+i] = true" (mouseleave)="rpt['6p'+i] = false" class="shift6 phonepe">
                {{rpt.shift6p == null ? 'No Rec' : rpt.shift6p}}
                <span *ngIf="rpt['6p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:30 pm to closing</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader2"
                [ngClass]="{'excess': rpt.shift6c > margin, 'shortage': rpt.shift6c < margin*-1, 'tallied': rpt.shift6c >= margin*-1 && rpt.shift6c <= margin && rpt.shift6c != null}"
                class="gap-right" (mouseenter)="rpt['6c'+i] = true" (mouseleave)="rpt['6c'+i] = false"
                class="shift6 cardpt">
                {{rpt.shift6c == null ? 'No Rec' : rpt.shift6c}}
                <span *ngIf="rpt['6c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:30 pm to closing</span>
                </span>
              </td>
              <!-- <td *ngIf="i == 0" class="td-border" [attr.rowspan]="denomcheckreports.length"></td> -->
              <td
                [ngClass]="{'excess': rpt.shift7s > margin, 'shortage': rpt.shift7s < margin*-1, 'tallied': rpt.shift7s >= margin*-1 && rpt.shift7s <= margin && rpt.shift7s != null}"
                (mouseenter)="rpt['7s'+i] = true" (mouseleave)="rpt['7s'+i] = false" *ngIf="!hideHeader2"
                class="shift7 cash">
                {{rpt.shift7s == null ? 'No Rec' : rpt.shift7s}}
                <span *ngIf="rpt['7s'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>10:00 pm to closing</span>
                </span>
              </td>
              <td *ngIf="phonepe && !hideHeader2"
                [ngClass]="{'excess': rpt.shift7p > margin, 'shortage': rpt.shift7p < margin*-1, 'tallied': rpt.shift7p >= margin*-1 && rpt.shift7p <= margin && rpt.shift7p != null}"
                (mouseenter)="rpt['7p'+i] = true" (mouseleave)="rpt['7p'+i] = false" class="shift7 phonepe">
                {{rpt.shift7p == null ? 'No Rec' : rpt.shift7p}}
                <span *ngIf="rpt['7p'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:30 pm to closing</span>
                </span>
              </td>
              <td *ngIf="card && !hideHeader2"
                [ngClass]="{'excess': rpt.shift7c > margin, 'shortage': rpt.shift7c < margin*-1, 'tallied': rpt.shift7c >= margin*-1 && rpt.shift7c <= margin && rpt.shift7c != null}"
                (mouseenter)="rpt['7c'+i] = true" (mouseleave)="rpt['7c'+i] = false" class="shift7 cardpt">
                {{rpt.shift7c == null ? 'No Rec' : rpt.shift7c}}
                <span *ngIf="rpt['7c'+i]" class="hover-info shadow">
                  <span>{{rpt.Name}}</span><br>
                  <span>08:30 pm to closing</span>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button class="btn btn-primary" (click)="downloadTableAsImage()">Download as Image</button>
    <!-- <button type="button" class="btn btn-primary" (click)="exportdenomcheck()">Excel Download</button> -->
  </div>
</ng-template>